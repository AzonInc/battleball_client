<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Battleball</title>
  <style type="text/css">
  body
  {
    margin: 0 auto;
    background-color: #00aaaa;
    color: #dddddd;
  }
  canvas
  {
    position: absolute;
    width: 100%;
    position: absolute;
    width: 100%;
    height: 100%;
  }
  </style>

  <script src="./web-gallery/js/furnitureimager.js"></script>

  <script>
  let Game = {};
  window.onload = function () {
    const canvas = document.querySelector('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    Game.furnitureImager = new FurnitureImager();

    ctx.fillStyle = "#00aaaa";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    Game.furnitureImager.initialize().then(() => {

      const itemId = 4651;
      const size = 64;

      Game.furnitureImager.generateRoomItem(itemId, 64).then((sprites) => {
        let i = 100;
        for (spriteId in sprites.sprites) {


          //Particle drawing
          for (layer of sprites.sprites[spriteId].layers) {
            if (layer.additive) {
              ctx.globalCompositeOperation = "lighter";
            } else {
              ctx.globalCompositeOperation = "source-over";
            }
            ctx.drawImage(layer.img, i + layer.posX, layer.posY + 100);
          }


          /*
          //Basic drawing
          //console.log(sprites.sprites[spriteId]);
          ctx.globalCompositeOperation = "source-over";
          //ctx.globalCompositeOperation = "lighter";
          ctx.drawImage(sprites.sprites[spriteId].sprite, i, 100);
          if (sprites.sprites[spriteId].additiveSprite != null) {
            ctx.globalCompositeOperation = "lighter";
            ctx.drawImage(sprites.sprites[spriteId].additiveSprite, i, 100);
          }
          */


          i += sprites.sprites[spriteId].sprite.width + 10;
        }
      });

    });
  };

  </script>

</head>
<body>
  <canvas id="game"></canvas>
</body>
</html>
